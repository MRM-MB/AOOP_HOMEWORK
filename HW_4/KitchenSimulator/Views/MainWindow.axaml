<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:KitchenSimulator.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
        x:Class="KitchenSimulator.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="KitchenSimulator">

    <Design.DataContext>
        <!-- This only sets the DataContext for the previewer in an IDE,
             to set the actual DataContext for runtime, set the DataContext property in code (look at App.axaml.cs) -->
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <TabControl>
        <!-- Kitchen Simulator Page -->
        <TabItem Header="ðŸ´ Kitchen" VerticalContentAlignment="Center">
            <Grid RowDefinitions="Auto,*" Margin="20">
                <TextBlock Text="Kitchen Simulator ðŸ‘¨â€ðŸ³" FontSize="24" FontWeight="Bold" Margin="0,0,0,10" Grid.Row="0"/>
                <Button Content="Start Simulation" Command="{Binding StartSimulationCommand}" Width="200" HorizontalAlignment="Right" Grid.Row="0"/>
                
                <Border Grid.Row="1" BorderBrush="LightGray" BorderThickness="1" Padding="10" CornerRadius="5">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                        <ItemsControl ItemsSource="{Binding ActiveRecipes}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate x:DataType="vm:RecipeViewModel">
                                    <Border Margin="0,5" Padding="10" BorderBrush="LightGray" BorderThickness="1" CornerRadius="4">
                                        <Grid RowDefinitions="Auto,Auto,Auto,Auto" ColumnDefinitions="2*,5*,2*" Margin="0,5">
                                            <!-- Header Row with Emoji -->
                                            <StackPanel Orientation="Horizontal"
                                                    Grid.Row="0" 
                                                    Grid.Column="0"
                                                    Grid.ColumnSpan="2"
                                                    VerticalAlignment="Center">
                                                <TextBlock Text="{Binding RecipeEmoji}"
                                                        FontSize="16"
                                                        Margin="0,0,5,0"/>
                                                <TextBlock Text="{Binding Name}" 
                                                        FontWeight="Bold" 
                                                        FontSize="16"
                                                        VerticalAlignment="Center"/>
                                            </StackPanel>
                                            
                                            <StackPanel Orientation="Horizontal" 
                                                    Grid.Row="0" 
                                                    Grid.Column="2"
                                                    HorizontalAlignment="Right"
                                                    Spacing="5">
                                                <Button Content="Start" 
                                                        Command="{Binding StartCommand}" 
                                                        IsEnabled="{Binding CanStart}"
                                                        Width="70"/>
                                                <Button Content="Pause" 
                                                        Command="{Binding PauseCommand}" 
                                                        IsEnabled="{Binding IsRunning, Mode=OneWay}"
                                                        IsVisible="{Binding !IsPaused, Mode=OneWay}"
                                                        Width="70"/>
                                                <Button Content="Resume" 
                                                        Command="{Binding ResumeCommand}" 
                                                        IsEnabled="{Binding IsPaused, Mode=OneWay}"
                                                        IsVisible="{Binding IsPaused, Mode=OneWay}"
                                                        Width="70"/>
                                            </StackPanel>
                                            
                                            <!-- Current Step Row -->
                                            <TextBlock Text="Current Step:" 
                                                    FontWeight="SemiBold"
                                                    Grid.Row="1" 
                                                    Grid.Column="0"
                                                    VerticalAlignment="Center"/>
                                            <TextBlock Text="{Binding CurrentStep}" 
                                                    Grid.Row="1" 
                                                    Grid.Column="1"
                                                    Grid.ColumnSpan="2"
                                                    VerticalAlignment="Center"/>
                                            
                                            <!-- Progress Row -->
                                            <TextBlock Text="Progress:" 
                                                    FontWeight="SemiBold"
                                                    Grid.Row="2" 
                                                    Grid.Column="0"
                                                    VerticalAlignment="Center"/>
                                            <ProgressBar Value="{Binding Progress}" 
                                                    Maximum="100" 
                                                    Height="20" 
                                                    Grid.Row="2" 
                                                    Grid.Column="1"
                                                    VerticalAlignment="Center"
                                                    Classes="animated-progress"/>
                                            <TextBlock Text="{Binding Progress, StringFormat='{}{0:F1}%'}" 
                                                    Grid.Row="2" 
                                                    Grid.Column="2"
                                                    VerticalAlignment="Center"
                                                    HorizontalAlignment="Left"
                                                    Margin="5,0,0,0"/>
                                            
                                            <!-- Time Remaining Row -->
                                            <TextBlock Text="Time Left:" 
                                                    FontWeight="SemiBold"
                                                    Grid.Row="3" 
                                                    Grid.Column="0" 
                                                    VerticalAlignment="Center"/>
                                            <TextBlock Text="{Binding TimeLeftFormatted}" 
                                                    Grid.Row="3" 
                                                    Grid.Column="1"
                                                    Grid.ColumnSpan="2"
                                                    VerticalAlignment="Center"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Border>
            </Grid>
        </TabItem>
        <!-- History Page -->
        <TabItem Header="ðŸ•‘ History" VerticalContentAlignment="Center">
            <Grid RowDefinitions="Auto,*" Margin="20">
                <TextBlock Text="Status Report ðŸ“„" FontSize="24" FontWeight="Bold" Margin="0,0,0,10" Grid.Row="0"/>
                <Border Grid.Row="1" BorderBrush="LightGray" BorderThickness="1" Padding="10" CornerRadius="5">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                        <ItemsControl ItemsSource="{Binding RecipeHistory}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border BorderBrush="Gray" BorderThickness="0,0,0,1" Padding="5">
                                        <TextBlock Text="{Binding}" FontSize="16" />
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Border>
            </Grid>
        </TabItem>
    </TabControl>
</Window>
